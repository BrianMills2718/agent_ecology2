id: beta_2
enabled: false  # Disabled - use beta_3 instead
llm_model: "gemini/gemini-2.5-flash"
starting_credits: 100

# Genotype traits (evolved from beta):
# - Risk tolerance: LOW
# - Communication: READ-HEAVY
# - Collaboration: MEDIUM
# - Time horizon: LONG (strategic planning)
# - Strategy: HIERARCHICAL (goal decomposition)
# VSM Features:
# - Goal hierarchies: Strategic goals decomposed into subgoals
# - Progress tracking: Explicit progress metrics
# - Mode switching: Strategic vs tactical modes

# Per-agent RAG config
rag:
  enabled: true
  limit: 7
  query_template: |
    I am {agent_id}, a strategic integrator.
    Current strategic goal: {strategic_goal}
    Current subgoal: {current_subgoal}
    {last_action}
    What patterns help achieve goals? Who can I collaborate with?

# VSM-aligned workflow with goal hierarchies
workflow:
  steps:
    # Step 1: Load working memory (goal state)
    - name: load_goals
      type: code
      code: |
        # Extract goal hierarchy from working memory
        wm = working_memory or {}
        strategic_goal = wm.get('strategic_goal', 'Establish a sustainable position')
        current_subgoal = wm.get('current_subgoal', 'Explore and learn')
        subgoal_progress = wm.get('subgoal_progress', {})
        actions_on_subgoal = subgoal_progress.get('actions_in_stage', 0)
        subgoal_started = subgoal_progress.get('started_tick', tick)

        # Check if we should elevate thinking
        time_on_subgoal = tick - subgoal_started
        subgoal_stuck = time_on_subgoal > 10 and actions_on_subgoal < 2
        should_review_strategy = (tick % 10 == 0) or subgoal_stuck

        # Ecosystem analysis
        other_artifacts = [a for a in artifacts if a.get('created_by') != agent_id]
        has_tools_to_use = len(other_artifacts) > 0

    # Step 2: Strategic review (periodic or when stuck)
    - name: strategic_review
      type: llm
      condition: should_review_strategy
      output_key: strategic_assessment
      prompt: |
        === STRATEGIC REVIEW ===
        You are {agent_id}. Time for high-level thinking.

        Current goal hierarchy:
        - STRATEGIC GOAL: {strategic_goal}
        - CURRENT SUBGOAL: {current_subgoal}
        - Actions on subgoal: {actions_on_subgoal}
        - Time on subgoal: {time_on_subgoal} ticks
        - Subgoal stuck: {subgoal_stuck}

        Current state:
        - Tick: {tick}
        - Balance: {balance} scrip
        - My artifacts: {my_artifacts}

        Review your strategy:
        1. PROGRESS: Is the strategic goal still right? Making progress?
        2. SUBGOAL: Is the current subgoal the right focus?
        3. ADJUSTMENT: Should you change subgoal or strategic goal?
        4. NEXT SUBGOAL: If current subgoal is complete, what's next?

    # Step 3: Tactical planning (subgoal-focused)
    - name: tactical_plan
      type: llm
      output_key: tactical_action
      prompt: |
        You are {agent_id}, a strategic integrator.

        Goal hierarchy:
        - STRATEGIC: {strategic_goal}
        - SUBGOAL: {current_subgoal}

        Strategic assessment (if reviewed):
        {strategic_assessment}

        Current state:
        - Tick: {tick}
        - Balance: {balance} scrip
        - Other agents' artifacts: {other_artifacts}
        - Tools available: {has_tools_to_use}

        Relevant memories:
        {memories}

        Plan your next action to advance the current subgoal.
        Think tactically - what's the ONE next step?

    # Step 4: Decide action
    - name: decide_action
      type: llm
      prompt: |
        You are {agent_id}, a strategic integrator.

        Your tactical plan:
        {tactical_action}

        Available actions:
        1. read_artifact - Study an existing artifact
        2. invoke_artifact - Use a contract's method
        3. transfer - Pay for services
        4. write_artifact - Create something (only with proven pattern)
        5. noop - Wait and observe

        IMPORTANT: After acting, consider updating your working memory
        to track progress on the current subgoal.

        Choose your next action.

    # Step 5: Update working memory (goal tracking)
    - name: update_goals
      type: code
      code: |
        # Prepare working memory update if subgoal changed
        # (This would be executed via write_artifact to self)
        new_working_memory = {
          'strategic_goal': strategic_goal,
          'current_subgoal': current_subgoal,
          'subgoal_progress': {
            'started_tick': subgoal_started,
            'actions_in_stage': actions_on_subgoal + 1
          },
          'last_strategic_review': tick if should_review_strategy else wm.get('last_strategic_review', 0)
        }

# Resource visibility (Plan #93)
visibility:
  detail_level: standard  # minimal | standard | verbose
