# =============================================================================
# AGENT ECOLOGY - CONFIG SCHEMA
# =============================================================================
# This defines the structure. See config.yaml for actual values.
# No numbers should appear in code - only here.
# =============================================================================

# -----------------------------------------------------------------------------
# RESOURCES
# All map to real physical/financial scarcity
# -----------------------------------------------------------------------------
resources:
  # Stock resources: finite pool, don't refresh, distributed initially
  stock:
    llm_budget:
      total: <number>           # Total $ for API calls (user's budget)
      unit: dollars
      distribution: equal       # How to split among agents: equal | weighted | custom
    disk:
      total: <number>           # Total bytes available
      unit: bytes
      distribution: equal

  # Flow resources: rate-limited, refresh per tick
  flow:
    compute:                    # LLM token budget (stored as "llm_tokens" in ledger)
      per_tick: <number>        # Token-units available per tick (~1K tokens each)
      unit: token_units
      distribution: equal       # Quota per agent
    bandwidth:
      per_tick: <number>        # Bytes of network I/O per tick
      unit: bytes
      distribution: equal

# -----------------------------------------------------------------------------
# SCRIP
# Economic currency - NOT a resource, just medium of exchange
# -----------------------------------------------------------------------------
scrip:
  starting_amount: <number>     # Each agent starts with this much
  # Note: scrip has no "total" - it's created via oracle minting and destroyed via fees

# -----------------------------------------------------------------------------
# COSTS
# Token costs for thinking (real physical costs)
# Actions themselves are free. Real costs come from:
# - LLM tokens (thinking) - costs from your budget
# - Disk usage (writing) - costs from your disk quota
# - Genesis method costs (configurable per-method below)
# -----------------------------------------------------------------------------
costs:
  per_1k_input_tokens: <number>   # Compute cost per 1K input tokens
  per_1k_output_tokens: <number>  # Compute cost per 1K output tokens

# -----------------------------------------------------------------------------
# GENESIS ARTIFACTS
# System-provided services - fully configurable
# Each artifact can be enabled/disabled and has configurable methods
# -----------------------------------------------------------------------------
genesis:
  # Which artifacts to create (set to false to disable)
  artifacts:
    ledger:
      enabled: <boolean>        # Enable genesis_ledger
    oracle:
      enabled: <boolean>        # Enable genesis_oracle
    rights_registry:
      enabled: <boolean>        # Enable genesis_rights_registry
    event_log:
      enabled: <boolean>        # Enable genesis_event_log

  # Genesis Ledger - balance queries and transfers
  ledger:
    id: <string>                # Artifact ID (default: genesis_ledger)
    description: <string>       # Artifact description
    methods:
      balance:
        cost: <number>          # Scrip cost (0 = free)
        description: <string>
      all_balances:
        cost: <number>
        description: <string>
      transfer:
        cost: <number>          # Fee to transfer scrip
        description: <string>
      spawn_principal:
        cost: <number>          # Fee to spawn new principal
        description: <string>

  # Genesis Oracle - auction-based scoring and minting
  oracle:
    id: <string>
    description: <string>
    mint_ratio: <number>        # score / ratio = scrip minted

    # Auction configuration (Vickrey auction for scoring slots)
    auction:
      period: <number>          # Ticks between auctions
      bidding_window: <number>  # Duration of bidding phase (ticks)
      first_auction_tick: <number>  # Grace period before first auction
      slots_per_auction: <number>   # Winners per auction
      minimum_bid: <number>     # Floor bid amount
      tie_breaking: <string>    # "random" or "first_bid"
      show_bid_count: <boolean> # Show number of bids during window
      allow_bid_updates: <boolean>  # Can agents update their bid?
      refund_on_scoring_failure: <boolean>  # Refund if LLM scoring fails

    methods:
      status:
        cost: <number>          # Check auction status (phase, tick, bid count)
        description: <string>
      bid:
        cost: <number>          # Submit sealed bid during bidding window
        description: <string>
      check:
        cost: <number>          # Check scoring result for an artifact
        description: <string>

  # Genesis Rights Registry - quota management
  rights_registry:
    id: <string>
    description: <string>
    methods:
      check_quota:
        cost: <number>
        description: <string>
      all_quotas:
        cost: <number>
        description: <string>
      transfer_quota:
        cost: <number>          # Fee to transfer quota
        description: <string>

  # Genesis Event Log - passive observability
  event_log:
    id: <string>
    description: <string>
    max_per_read: <number>      # Cap events returned per read
    buffer_size: <number>       # Internal buffer size
    methods:
      read:
        cost: <number>
        description: <string>

  # Genesis Store - artifact discovery and registry
  store:
    id: <string>
    description: <string>
    methods:
      list:
        cost: <number>          # List artifacts with optional filter
        description: <string>
      get:
        cost: <number>          # Get single artifact details
        description: <string>
      search:
        cost: <number>          # Search by content match
        description: <string>
      list_by_type:
        cost: <number>          # Filter by artifact type
        description: <string>
      list_by_owner:
        cost: <number>          # Filter by owner
        description: <string>
      list_agents:
        cost: <number>          # List agent artifacts only
        description: <string>
      list_principals:
        cost: <number>          # List principals (has_standing=True)
        description: <string>
      count:
        cost: <number>          # Count artifacts matching filter
        description: <string>

# -----------------------------------------------------------------------------
# RATE LIMITING
# Rolling window rate limiting (time-based, not tick-based)
# -----------------------------------------------------------------------------
rate_limiting:
  enabled: <boolean>              # Enable rate limiting (default: false)
  window_seconds: <number>        # Rolling window duration (default: 60.0)
  resources:                      # Per-resource limits
    llm_calls:
      max_per_window: <number>    # Max LLM API calls per window
    disk_writes:
      max_per_window: <number>    # Max disk write operations per window
    bandwidth_bytes:
      max_per_window: <number>    # Max bytes transferred per window

# -----------------------------------------------------------------------------
# EXECUTION
# Agent execution model settings
# -----------------------------------------------------------------------------
execution:
  use_autonomous_loops: <boolean>  # Enable continuous autonomous loops (default: false)
  agent_loop:
    min_loop_delay: <number>       # Minimum seconds between actions (default: 0.1)
    max_loop_delay: <number>       # Maximum backoff delay on errors (default: 10.0)
    resource_check_interval: <number>  # Seconds between resource checks when paused (default: 1.0)
    max_consecutive_errors: <number>   # Errors before forced pause (default: 5)
    resources_to_check:            # Resource types to check before each iteration
      - <string>                   # e.g., "llm_calls", "disk_writes", "bandwidth_bytes"
    resource_exhaustion_policy: <string>  # Policy when resources exhausted: "skip" or "block" (default: "skip")
                                          # - "skip": Skip action, sleep briefly, try again next iteration
                                          # - "block": Block until capacity available using wait_for_capacity

# -----------------------------------------------------------------------------
# EXECUTOR
# Code execution settings
# -----------------------------------------------------------------------------
executor:
  timeout_seconds: <number>     # Max time for agent code to run
  allowed_imports:              # Whitelist of importable modules
    - math
    - json
    - random
    - datetime

# -----------------------------------------------------------------------------
# VALIDATION
# Input validation limits to prevent DoS attacks
# -----------------------------------------------------------------------------
validation:
  max_artifact_id_length: <number>  # Max chars for artifact IDs (default: 128)
  max_method_name_length: <number>  # Max chars for method names (default: 64)

# -----------------------------------------------------------------------------
# ORACLE SCORER
# External LLM scoring settings
# -----------------------------------------------------------------------------
oracle_scorer:
  model: <string>               # LLM model for scoring
  timeout: <number>             # Seconds
  max_content_length: <number>  # Truncate content beyond this

# -----------------------------------------------------------------------------
# LLM
# Agent LLM settings
# -----------------------------------------------------------------------------
llm:
  default_model: <string>       # Default model for new agents
  timeout: <number>
  rate_limit_delay: <number>    # Seconds between calls
  allowed_models:               # Models agents are permitted to use
    - <string>                  # Future: agents can switch within this list

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
logging:
  output_file: <string>
  log_dir: <string>
  default_recent: <number>      # Default N for "recent events"

# -----------------------------------------------------------------------------
# WORLD
# Simulation settings
# -----------------------------------------------------------------------------
world:
  max_ticks: <number>

# -----------------------------------------------------------------------------
# BUDGET
# Global API spend limit
# -----------------------------------------------------------------------------
budget:
  max_api_cost: <number>        # $ limit (0 = unlimited)
  checkpoint_file: <string>     # Where to save state on pause

# -----------------------------------------------------------------------------
# DASHBOARD
# HTML visibility interface for monitoring simulation
# -----------------------------------------------------------------------------
dashboard:
  enabled: <boolean>            # Enable dashboard server
  host: <string>                # Host to bind (0.0.0.0 for all interfaces)
  port: <number>                # Port number (default: 8080)
  static_dir: <string>          # Path to static files directory
  jsonl_file: <string>          # Path to JSONL event log to monitor
  websocket_path: <string>      # WebSocket endpoint path
  cors_origins:                 # Allowed CORS origins
    - <string>
  max_events_cache: <number>    # Max events to cache in memory
