# =============================================================================
# AGENT ECOLOGY - CONFIGURATION
# =============================================================================
# All numbers that control the simulation. No magic numbers in code.
# See schema.yaml for documentation of each field.
# =============================================================================

# -----------------------------------------------------------------------------
# RESOURCES - Map to real physical/financial scarcity
# -----------------------------------------------------------------------------
resources:
  stock:  # Finite pool, don't refresh
    llm_budget:
      total: 1.00               # $ for API calls
      unit: dollars
      distribution: equal
    disk:
      total: 50000              # bytes total
      unit: bytes
      distribution: equal

  flow:  # Rate-limited, refresh per tick
    compute:
      per_tick: 1000            # cycles available per tick
      unit: cycles
      distribution: equal
    bandwidth:
      per_tick: 0               # 0 = disabled for now
      unit: bytes
      distribution: equal

# -----------------------------------------------------------------------------
# SCRIP - Economic currency (not a resource)
# -----------------------------------------------------------------------------
scrip:
  starting_amount: 100

# -----------------------------------------------------------------------------
# COSTS - What actions consume (compute units)
# -----------------------------------------------------------------------------
costs:
  actions:
    noop: 1
    read_artifact: 2
    write_artifact: 5
    invoke_artifact: 1
  execution_gas: 2
  default: 1
  # Token costs for thinking
  per_1k_input_tokens: 1
  per_1k_output_tokens: 3

# -----------------------------------------------------------------------------
# GENESIS ARTIFACTS - System services (fully configurable)
# -----------------------------------------------------------------------------
genesis:
  # Which artifacts to create
  artifacts:
    ledger:
      enabled: true
    oracle:
      enabled: true
    rights_registry:
      enabled: true
    event_log:
      enabled: true
    escrow:
      enabled: true

  # Genesis Ledger - balance queries and transfers
  ledger:
    id: "genesis_ledger"
    description: "System ledger - check balances (flow/scrip) and transfer scrip"
    methods:
      balance:
        cost: 0                 # Free - reading balance shouldn't cost
        description: "Get flow and scrip balance for an agent. Args: [agent_id]"
      all_balances:
        cost: 0                 # Free - public information
        description: "Get all agent balances (flow and scrip). Args: []"
      transfer:
        cost: 1                 # 1 scrip fee
        description: "Transfer SCRIP to another agent. Args: [from_id, to_id, amount]"
      spawn_principal:
        cost: 1                 # 1 scrip processing fee
        description: "Spawn a new principal with 0 scrip and 0 compute. Args: []"
      transfer_ownership:
        cost: 1                 # 1 scrip fee
        description: "Transfer artifact ownership to another principal. Args: [artifact_id, to_id]"

  # Genesis Oracle - external scoring and minting
  oracle:
    id: "genesis_oracle"
    description: "External feedback oracle - submit artifacts for LLM scoring"
    mint_ratio: 10              # score / 10 = scrip minted
    methods:
      status:
        cost: 0                 # Free status check
        description: "Check oracle status. Args: []"
      submit:
        cost: 5                 # 5 scrip fee to submit
        description: "Submit artifact for scoring. Args: [artifact_id]"
      check:
        cost: 0                 # Free to check
        description: "Check submission status. Args: [artifact_id]"
      process:
        cost: 0                 # Free - encourages processing
        description: "Process one pending submission with LLM scoring. Args: []"

  # Genesis Rights Registry - quota management
  rights_registry:
    id: "genesis_rights_registry"
    description: "Rights registry - manage compute and disk quotas"
    methods:
      check_quota:
        cost: 0                 # Free quota check
        description: "Check quotas for an agent. Args: [agent_id]"
      all_quotas:
        cost: 0                 # Free - public information
        description: "Get all agent quotas. Args: []"
      transfer_quota:
        cost: 1                 # 1 scrip fee
        description: "Transfer quota to another agent. Args: [from_id, to_id, 'compute'|'disk', amount]"

  # Genesis Event Log - passive observability
  event_log:
    id: "genesis_event_log"
    description: "World event log - passive observability. Reading is free but costs input tokens."
    max_per_read: 100           # Cap events returned per read
    buffer_size: 1000           # Internal buffer size
    methods:
      read:
        cost: 0                 # Free in scrip - but consumes input tokens
        description: "Read recent events. Args: [offset, limit] - both optional. Default: last 50 events."

  # Genesis Escrow - trustless artifact trading
  escrow:
    id: "genesis_escrow"
    description: "Trustless escrow for artifact trading. Seller deposits, buyer purchases, escrow handles exchange."
    methods:
      deposit:
        cost: 1                 # 1 scrip fee to list
        description: "Deposit artifact for sale. First transfer ownership to escrow. Args: [artifact_id, price] or [artifact_id, price, buyer_id]"
      purchase:
        cost: 0                 # Free - buyer already pays the price
        description: "Purchase a listed artifact. Pays price to seller, transfers ownership to buyer. Args: [artifact_id]"
      cancel:
        cost: 0                 # Free - encourage cleanup
        description: "Cancel listing and return artifact to seller. Only seller can cancel. Args: [artifact_id]"
      check:
        cost: 0                 # Free status check
        description: "Check status of an escrow listing. Args: [artifact_id]"
      list_active:
        cost: 0                 # Free - encourage discovery
        description: "List all active escrow listings. Args: []"

# -----------------------------------------------------------------------------
# EXECUTOR
# -----------------------------------------------------------------------------
executor:
  timeout_seconds: 5
  # NOTE: These modules are PRE-LOADED into the execution namespace.
  # This is NOT a security whitelist - agents can import any stdlib module.
  # Security boundary is the container, not code-level sandboxing.
  # See docs/SECURITY.md for rationale.
  preloaded_imports:
    - math
    - json
    - random
    - datetime

# -----------------------------------------------------------------------------
# ORACLE SCORER
# -----------------------------------------------------------------------------
oracle_scorer:
  model: "gemini/gemini-3-flash-preview"
  timeout: 30
  max_content_length: 200000

# -----------------------------------------------------------------------------
# LLM
# -----------------------------------------------------------------------------
llm:
  default_model: "gemini/gemini-3-flash-preview"
  timeout: 60
  rate_limit_delay: 15
  # Models that agents are allowed to use (for future self-modification)
  allowed_models:
    - "gemini/gemini-3-flash-preview"

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
logging:
  output_file: "run.jsonl"
  log_dir: "llm_logs"
  default_recent: 50

# -----------------------------------------------------------------------------
# WORLD
# -----------------------------------------------------------------------------
world:
  max_ticks: 100

# -----------------------------------------------------------------------------
# BUDGET - Global API limit
# -----------------------------------------------------------------------------
budget:
  max_api_cost: 1.00            # $ (0 = unlimited)
  checkpoint_file: "checkpoint.json"
